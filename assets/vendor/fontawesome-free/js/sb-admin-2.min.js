/*!
 * Start Bootstrap - SB Admin 2 v4.0.7 (https://startbootstrap.com/template-overviews/sb-admin-2)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

!(function (t) {
	"use strict";
	t("#sidebarToggle, #sidebarToggleTop").on("click", function (o) {
		t("body").toggleClass("sidebar-toggled"),
			t(".sidebar").toggleClass("toggled"),
			t(".sidebar").hasClass("toggled") &&
				t(".sidebar .collapse").collapse("hide");
	}),
		t(window).resize(function () {
			t(window).width() < 768 && t(".sidebar .collapse").collapse("hide");
		}),
		t("body.fixed-nav .sidebar").on(
			"mousewheel DOMMouseScroll wheel",
			function (o) {
				if (768 < t(window).width()) {
					var e = o.originalEvent,
						l = e.wheelDelta || -e.detail;
					(this.scrollTop += 30 * (l < 0 ? 1 : -1)), o.preventDefault();
				}
			}
		),
		t(document).on("scroll", function () {
			100 < t(this).scrollTop()
				? t(".scroll-to-top").fadeIn()
				: t(".scroll-to-top").fadeOut();
		}),
		t(document).on("click", "a.scroll-to-top", function (o) {
			var e = t(this);
			t("html, body")
				.stop()
				.animate(
					{ scrollTop: t(e.attr("href")).offset().top },
					1e3,
					"easeInOutExpo"
				),
				o.preventDefault();
		});
})(jQuery);

function checkCustomerEmail(baseUrl) {
	var customer_email = $("#customer_email").val();
	if (customer_email != "") {
		$("#messageCustomerCheck").html("Checking....");

		$.post(
			baseUrl + "customer/searchbyemail",
			{ customer_email: customer_email },
			function (result) {
				if (result != null && result != "null") {
					$("#messageCustomerCheck").html(
						'<b class="text-success"><i class="fas fa-check"></i> Customer Record found</b>'
					);

					var jsonCustomer = JSON.parse(result);

					$("#customer_id").val(jsonCustomer["id"]);

					$("#customer_contact_no").val(jsonCustomer["contact_no"]);
					$("#customer_name").val(jsonCustomer["full_name"]);
					$("#customer_company").val(jsonCustomer["company"]);

					$("#customer_country").val(jsonCustomer["country"]);

					$.post(
						baseUrl + "customer/searchLocation",
						{ type: "state", value: jsonCustomer["state"] },
						function (result1) {
							if (result1 != null && result1 != "null") {
								var jsonLocation = JSON.parse(result1);

								$("#customer_state").append(
									'<option value="' +
										jsonLocation["id"] +
										'">' +
										jsonLocation["name"] +
										"</option>"
								);
								$("#customer_state").val(jsonLocation["id"]);
							}
						}
					);

					$.post(
						baseUrl + "customer/searchLocation",
						{ type: "city", value: jsonCustomer["city"] },
						function (result2) {
							if (result2 != null && result2 != "null") {
								var jsonLocation = JSON.parse(result2);

								$("#customer_city").append(
									'<option value="' +
										jsonLocation["id"] +
										'">' +
										jsonLocation["name"] +
										"</option>"
								);
								$("#customer_city").val(jsonLocation["id"]);
							}
						}
					);
				} else {
					$("#messageCustomerCheck").html(
						'<b class="text-danger"><i class="fa fa-times" aria-hidden="true"></i> Customer Data Not found</b>'
					);

					$("#customer_id").val(0);
					$("#customer_contact_no").val("");
					$("#customer_name").val("");
					$("#customer_company").val("");
					$("#customer_country").val(0);
					$("#customer_state").val(0);
					$("#customer_city").val(0);
				}
			}
		);
	} else {
		alert("Enter Customer Email");
	}
} // checkCustomerEmail

jQuery(".add").click(function () {
	jQuery(".form-group:last").before("");
});

function getLocationList(baseUrl, type, value, nextdiv) {
	if (type != "" && value != "") {
		$.post(
			baseUrl + "customer/getLocationList",
			{ type: type, value: value },
			function (result2) {
				// alert(result2)
				if (result2 != null && result2 != "null") {
					var jsonLocation = JSON.parse(result2);

					$("#customer_" + nextdiv)
						.empty()
						.append('<option selected="selected" value="">Select</option>');

					$.each(jsonLocation, function (id, value) {
						$("#customer_" + nextdiv).append(
							$("<option></option>").val(value.id).html(value.name)
						);
					});

					// $('#customer_'+nextdiv).append('<option value="' + jsonLocation['id'] + '">' + jsonLocation['name'] + '</option>');
					// $('#customer_city').val(jsonLocation['id']);
				}
			}
		);
	} else {
		return false;
	}
} // getLocationList

function addtorfq(baseUrl, detailsId) {
	$("#hiddenDetailsId").val(detailsId);
	$("#myModalRFQ").modal({ show: true });

	/*
	if (detailsId > 0) {
		// Add to RFQ Table

		$.post(
			baseUrl + "enquiry/addrfq",
			{ detailsId: detailsId },
			function (result2) {
				console.log(result2);
				if (result2 != null && result2 != "null") {
					alert("Product sent to Purchase Dept for RFQ");
					$("#rfq_" + detailsId)
						.html("RFQ Sent")
						.removeClass("btn-info")
						.addClass("btn-success")
						.removeAttr("href");
					// var jsonLocation = JSON.parse(result2);
				}
			}
		);
	}
    */
}

function openModal(name, url) {
	$.get(url, {}, function (result2) {
		$("#myModal").modal({ show: true });
		$("#myModal .modal-title").html(name);
		$("#myModal .modal-body").html(result2);
	});

	/*
	$(".modal-body").load(url, function () {
		$("#myModal").modal({ show: true });
	});
    */
} // openModal

$(".decimal").keyup(function () {
	var val = $(this).val();
	if (isNaN(val)) {
		val = val.replace(/[^0-9\.]/g, "");
		if (val.split(".").length > 2) val = val.replace(/\.+$/, "");
	}
	$(this).val(val);
});

function deleteProduct(url) {
	var result = confirm("Want to delete Product?");
	if (result) {
		window.location = url;
	} else {
		return false;
	}
} // deleteProduct

function deleteEnquiry(baseUrl, enquiryId, back) {
	var result = confirm("Want to delete Enquiry?");
	if (result) {
		$.post(
			baseUrl + "enquiry/delete",
			{ enquiryId: enquiryId },
			function (result) {
				if (result == 1) {
					alert("Enquiry Deleted");
					window.location = baseUrl + "enquiry/index/" + back;
				} else {
					alert("Error!!! While deleting enquiry");
				}
			}
		);
	} else {
		return false;
	}
}
